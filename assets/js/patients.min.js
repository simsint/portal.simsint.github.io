$((function(){var e={init:function(){e.getUsers({order_by:"given_name"})},getUsers:function(e){asyncResponse("GET","/admin/users",e,r=>{sessionStorage.setItem("users_paging_token",null!=r.paginationToken?r.PaginationToken:""),(e.hasOwnProperty("given_name")||e.hasOwnProperty("userid")||e.hasOwnProperty("middle_name")||e.hasOwnProperty("email"))&&$("#users-list").html(""),r.Items.forEach(e=>{$("#users-list").append(renderUserHtml(e))})})}};function r(e,r){$("#"+r).croppie("result",{type:"blob",size:"viewport"}).then((function(s){let t=s;$.ajax({url:e,type:"PUT",data:t,contentType:"image/jpeg",processData:!1,cache:!1,error:function(e){console.error("error",e),dangerToast("Error While Upload Images")},success:function(e){console.log("success -"+r,e)}})}))}e.init(),$("#users-list").html(""),$("#users-filter-form").on("submit",(function(r){r.preventDefault();let s=form2js(this,".",!0,null);console.log(s),"email"===s.filter_name||"preferred_username"===s.filter_name?s.userid=s.filter_value:s[s.filter_name]=$(`#patient-select option[value='${s.filter_value}']`).text(),s.order_by="given_name",console.log(s),e.getUsers(s)})),$("#send-invite").change((function(){this.checked?$("#send-invite-email,#send-invite-sms").removeAttr("disabled"):$("#send-invite-email, #send-invite-sms").attr("disabled","disabled")})),1==$("#send-invite-sms").prop("checked")&&$("#new-user-phone").val(),$("#create-user").on("submit",(function(e){if(e.preventDefault(),1==$("#send-invite").prop("checked")&&1==$("#send-invite-sms").prop("checked")&&""==$("#new-user-phone").val())return void $(".error-msg").removeClass("d-none").html("You must enter a phone number if SMS is checked as a desired delivery medium.");let r=form2js("create-user",".",!0,null);null!=r.phone_number&&(r.phone_number="+"+$(".tel-phone-input").intlTelInput("getSelectedCountryData").dialCode+r.phone_number),asyncResponse("POST","/admin/users",r,e=>{if(201!=e.statusCode||e.hasOwnProperty("message"))return $(".error-msg").removeClass("d-none").html(e.message),void dangerToast("Unable to Create User");$(".modal").modal("hide"),successToast("Successfully created new user"),$("#create-user").trigger("reset")})})),$("#update-user").on("submit",(function(e){e.preventDefault();let s=form2js("update-user",".",!0,null);null!=s.phone_number&&(s.phone_number="+"+$(".tel-phone-input").intlTelInput("getSelectedCountryData").dialCode+s.phone_number),asyncResponse("PUT","/admin/users",s,e=>{200!=e.statusCode||e.hasOwnProperty("message")?$(".error-msg").removeClass("d-none").html(e.message):(e.hasOwnProperty("custom:emirates_id_front")&&r(e["custom:emirates_id_front"],"emirates_id_front_preview"),e.hasOwnProperty("custom:emirates_id_back")&&r(e["custom:emirates_id_back"],"emirates_id_back_preview"),e.hasOwnProperty("profile")&&r(e.profile,"profile_preview"),$(".modal").modal("hide"),successToast("Successful"),$("form#update-user").trigger("reset"))})})),$("#report-chart-2 canvas").css("margin","auto").css("width","95%");document.querySelector("#report-chart-2 canvas").chart.chart.config={type:"pie",data:{labels:["Yes","Nearly Yes","Nearly No","No"],datasets:[{backgroundColor:["#d61010","#efa524","#f7e927","#94ef24"],borderColor:["rgba(0,0,0,0.1)","rgba(0,0,0,0.1)"],data:[1,1,1,1],datalabels:{color:"#000",align:"center",anchor:"center",font:{weight:"bold"},formatter:function(e,r){return e+" %"}}}]}}}));