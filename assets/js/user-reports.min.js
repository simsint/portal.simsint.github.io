let siteUsersData=[],siteUsersTable=$("#site-survey-datatable").DataTable({pagingType:"simple",lengthChange:!1,info:!1,ordering:!1,filter:!0,data:siteUsersData,columns:[{title:""},{title:"Email"},{title:"Date"}],columnDefs:[{searchable:!1,orderable:!1,targets:0,width:30,className:"details-control",data:null,defaultContent:""}]});function initSiteUsersDatatable(e){$.each(e.body.Items,(function(e,t){let a=new Date(t.created);siteUsersData.push([t.created,t.email,a.toString("YYYY-MM-dd")])})),siteUsersTable.clear(),siteUsersTable.rows.add(siteUsersData),siteUsersTable.draw(),siteUsersTable.on("search.dt",(function(){searchDate=$("#site-survey-datatable_filter label input[type=search]").val(),searchDate.length>4&&alert("search")}))}$("#site-survey-datatable tbody").on("click","td.details-control",(function(){var e=siteUsersTable.row($(this).parents("tr")).data();$.post(CORS+ENDPOINT+"/survey",JSON.stringify({email:e[1],date:e[0]}),(function(e,t,a){"200"==e.statusCode&&drawChart(e.body.Items[0].survey)}),"json")})),asyncResponse("GET","/admin/surveys",null,e=>{initSiteUsersDatatable(e)});