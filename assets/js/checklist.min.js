let surveyData="";var user_report_chart=document.querySelector("#user-report-chart canvas").chart;function setChartConfig(){user_report_chart.chart.config={type:"horizontalBar",data:{datasets:[{backgroundColor:["#dc3912","#ff9900","#109618","#0099c6","#dd4477","#66aa00","#b82e2e","#316395","#994499","#22aa99","#aaaa11","#6633cc","#c845e6","#e6de45"],datalabels:{color:"white",align:"center",anchor:"center",font:{weight:"bold"}}}]},responsive:!0},user_report_chart.chart.options={events:["click"],onClick:handleChartClick,title:{display:!0,text:"Behaviour Chart",position:"top",fontSize:14},scales:{xAxes:[{ticks:{beginAtZero:!0,max:100},gridLines:{display:!1}}],yAxes:[{ticks:{beginAtZero:!0}}]},legend:{display:!1},layout:{padding:{left:50,right:50,top:0,bottom:0}}}}function handleChartClick(t){var e=user_report_chart.getElementAtEvent(t);e[0]._view.label,e[0]._index}function drawChart(t){console.log(t),setChartConfig(),surveyData=t;var e={};let a=[],r=[];null!=t&&($.each(t.sections,(function(t,o){let s=o.totalQuestions/(5*o.totalQuestions),n=0;$.each(o.questions,(function(t,a){n+=a.value*s,e[a.en]=a.value}));let i=100*n/o.totalQuestions;"scale"===o.sectionType&&(a.push(o.title.en),r.push(parseFloat(i.toFixed(1))))})),updateChart(a,r)),jQuery.isEmptyObject(t)||$("#check-list-graph").removeClass("d-none"),jQuery.isEmptyObject(e)||fillSurvey(e)}function updateChart(t,e){user_report_chart.data.labels=t,user_report_chart.data.datasets[0].data=e,user_report_chart.update()}function fillSurvey(t){$("#user-report-questions").removeClass("d-none"),$("#filledSurvey").html(surveyContent),showTab(currentTab),js2form(document.getElementById("filledSurvey"),t)}console.log(user_report_chart),$("#site-survey-datatable tbody").on("click","td.details-control",(function(){var t=siteUsersTable.row($(this).parents("tr")).data();$.post(CORS+ENDPOINT+"/survey",JSON.stringify({email:t[1],date:t[0]}),(function(t,e,a){"200"==t.statusCode&&drawChart(t.body.Items[0].survey)}),"json")})),$(window).resize((function(){drawChart(surveyData)}));