var calendarEl=document.getElementById("calendar"),calendar=new FullCalendar.Calendar(calendarEl,{expand:!0,navLinks:!0,selectable:!1,nowIndicator:!0,selectable:!0,selectOverlap:!1,dayMaxEvents:!0,stickyHeaderDates:!0,initialView:"dayGridMonth",headerToolbar:{left:"prev,next today adminFilter",center:"title",right:"dayGridMonth,timeGridWeek,resourceTimeGridDay,listMonth"},customButtons:{adminFilter:{text:"Filter",click:function(){}}},slotEventOverlap:!1,slotDuration:{minutes:30},selectConstraint:"businessHours",select:function(e){console.log("information - ",e);let t=new Date,n=new Date(e.startStr),a=new Date(e.endStr);("timeGridDay"==e.view.type||"resourceTimeGridDay"==e.view.type)&&n>t?($("#new-appointment-modal").modal("show"),$("#new-appointment-modal input[name='start']").val(moment(n).format("YYYY-MM-DDTHH:mm")),$("#new-appointment-modal input[name='end']").val(moment(a).format("YYYY-MM-DDTHH:mm"))):warningToast("Cannot Select Past Slot")},resources:[{id:"sims2020@ahmedalnajjar.com",title:"Dr. Ahmed Alnajjar",businessHours:{startTime:"08:00",endTime:"17:00"},eventBackgroundColor:"#4e73df",eventBorderColor:"#4e73df"}],events:{url:ENDPOINT+"/admin/appointments",extraParams:function(e){},success:function(e){return e.events},failure:function(e){alert("Error When trying to get appointments!")}},eventDataTransform:function(e){let t={};return t.id=e.id,t.title=e.summary,t.start=e.start.dateTime,t.end=e.end.dateTime,t.source=e.htmlLink,t.url=e.htmlLink,t.eventDisplay="list-item",t.resourceId=e.organizer.email,t},eventClick:function(e){let t=e.event._def.title,n=e.event._def.extendedProps.description,a=e.event._def.extendedProps.location,r=e.event.url;$("#event-text").html(t),$("#event-description").html(n),$("#event-location").html(a),$("#event-url").attr("href",r),$("#appointment-details-modal").modal("show"),e.jsEvent.preventDefault()}});calendar.render(),$("#create-appointment-form").on("submit",(function(e){e.preventDefault();let t=form2js(this,".",!0,null);t.start=new Date(t.start).toISOString(),t.end=new Date(t.end).toISOString(),$.ajax({url:ENDPOINT+"/appointments",method:"POST",crossDomain:!0,dataType:"json",data:JSON.stringify(t),processData:!1}).done((function(e){if(null!=e.errorMessage)$(".error-msg").removeClass("d-none").html("Appointment Created Successfully.\nUnable to save appointment details to DB.\nTake a photo and report to Development Team.\nError: "+e.errorMessage);else if(201!=e.statusCode||e.hasOwnProperty("message"))return void $(".error-msg").removeClass("d-none").html(e.message);$(".modal").modal("hide"),successToast("Appointment Registered Successful</p>"),$("#create-user").trigger("reset"),calendar.refetchEvents()})).fail((function(e){console.log("error - ",e),dangerToast("Appointment Registration Failed")}))}));